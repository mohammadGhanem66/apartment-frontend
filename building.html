<!DOCTYPE html>
<html lang="en" dir="rtl" class="rtl">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Twitter -->
    <meta name="twitter:site" content="@themepixels">
    <meta name="twitter:creator" content="@themepixels">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Bracket Plus">
    <meta name="twitter:description" content="Premium Quality and Responsive UI for Dashboard.">
    <meta name="twitter:image" content="http://themepixels.me/bracketplus/img/bracketplus-social.png">

    <!-- Facebook -->
    <meta property="og:url" content="http://themepixels.me/bracketplus">
    <meta property="og:title" content="Bracket Plus">
    <meta property="og:description" content="Premium Quality and Responsive UI for Dashboard.">

    <meta property="og:image" content="http://themepixels.me/bracketplus/img/bracketplus-social.png">
    <meta property="og:image:secure_url" content="http://themepixels.me/bracketplus/img/bracketplus-social.png">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="600">

    <!-- Meta -->
    <meta name="description" content="Premium Quality and Responsive UI for Dashboard.">
    <meta name="author" content="ThemePixels">

    <title>Dashboard Cards | Bracket Plus Responsive Bootstrap 4 Admin Template</title>

    <!-- vendor css -->
    <link href="lib/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
    <link href="lib/ionicons/css/ionicons.min.css" rel="stylesheet">
    <link href="lib/rickshaw/rickshaw.min.css" rel="stylesheet">

    <!-- Bracket CSS -->
    <link rel="stylesheet" href="css/bracket.css">
  </head>

  <body>

    <!-- ########## START: LEFT PANEL ########## -->
    <div class="br-logo"><a href=""><span>[</span>bracket <i>plus</i><span>]</span></a></div>
  <div class="br-sideleft sideleft-scrollbar">
      <label class="sidebar-label pd-x-10 mg-t-20 op-3">القائمة</label>
      <ul class="br-sideleft-menu">
        <li class="br-menu-item">
          <a href="index.html" class="br-menu-link ">
            <i class="menu-item-icon icon ion-ios-home-outline tx-24"></i>
            <span class="menu-item-label">الرئيسية</span>
          </a><!-- br-menu-link -->
        </li><!-- br-menu-item -->

       
    
        <li class="br-menu-item">
          <a href="#" class="br-menu-link with-sub active">
            <i class="menu-item-icon ion-ios-redo-outline tx-24"></i>
            <span class="menu-item-label">العمارات</span>
          </a><!-- br-menu-link -->
          <ul class="br-menu-sub">
            <li class="sub-item"><a href="building.html" class="sub-link active">العمارات</a></li>
            <li class="sub-item"><a href="apartment-create.html" class="sub-link">انشاء عمارة</a></li>
            <li class="sub-item"><a href="#" class="sub-link">التعديل على عمارة</a></li>
          </ul>
        </li><!-- br-menu-item -->
        <li class="br-menu-item">
          <a href="#" id="installLink">Install App</a>
        </li><!-- br-menu-item -->

      </ul><!-- br-sideleft-menu -->

    </div><!-- br-sideleft -->
    <!-- ########## END: LEFT PANEL ########## -->

    <!-- ########## START: HEAD PANEL ########## -->
    <div class="br-header">
      <div class="br-header-left">
        <div class="navicon-left hidden-md-down"><a id="btnLeftMenu" href=""><i class="icon ion-navicon-round"></i></a></div>
        <div class="navicon-left hidden-lg-up"><a id="btnLeftMenuMobile" href=""><i class="icon ion-navicon-round"></i></a></div>

      </div><!-- br-header-left -->
      <div class="br-header-right">
        <nav class="nav">
      
          <div class="dropdown">
            <a href="" class="nav-link pd-x-7 pos-relative" data-toggle="dropdown">
              <i class="icon ion-ios-bell-outline tx-24"></i>
              <!-- start: if statement -->
              <span class="square-8 bg-danger pos-absolute t-15 r-5 rounded-circle"></span>
              <!-- end: if statement -->
            </a>
            <div class="dropdown-menu dropdown-menu-header">
              <div class="dropdown-menu-label">
                <label>الاشعارات</label>
              </div><!-- d-flex -->

              <div class="media-list">
                <!-- loop starts here -->
                <a href="" class="media-list-link read">
                  <div class="media">
                    <img src="https://via.placeholder.com/500" alt="">
                    <div class="media-body">
                      <p class="noti-text">دفعة 500 مستحقة من قبل محمد</p>
                      <span>October 03, 2017 8:45am</span>
                    </div>
                  </div><!-- media -->
                </a>
                <!-- loop ends here -->
                <a href="" class="media-list-link read">
                  <div class="media">
                    <img src="https://via.placeholder.com/500" alt="">
                    <div class="media-body">
                    <p class="noti-text">دفعة 500 مستحقة من قبل محمد</p>
                      <span>October 02, 2017 12:44am</span>
                    </div>
                  </div><!-- media -->
                </a>
                <a href="" class="media-list-link read">
                  <div class="media">
                    <img src="https://via.placeholder.com/500" alt="">
                    <div class="media-body">
                 <p class="noti-text">دفعة 500 مستحقة من قبل محمد</p>
                      <span>October 01, 2017 10:20pm</span>
                    </div>
                  </div><!-- media -->
                </a>
                <a href="" class="media-list-link read">
                  <div class="media">
                    <img src="https://via.placeholder.com/500" alt="">
                    <div class="media-body">
                   <p class="noti-text">دفعة 500 مستحقة من قبل محمد</p>
                      <span>October 01, 2017 6:08pm</span>
                    </div>
                  </div><!-- media -->
                </a>
      
              </div><!-- media-list -->
            </div><!-- dropdown-menu -->
          </div><!-- dropdown -->
          <div class="dropdown">
            <a href="" class="nav-link nav-link-profile" data-toggle="dropdown">
              <span class="logged-name hidden-md-down">مصعب</span>
              <img src="https://via.placeholder.com/500" class="wd-32 rounded-circle" alt="">
              <span class="square-10 bg-success"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-header wd-250">
              <div class="tx-center">
                <a href=""><img src="https://via.placeholder.com/500" class="wd-80 rounded-circle" alt=""></a>
                <h6 class="logged-fullname">مصعب</h6>

              </div>

              <ul class="list-unstyled user-profile-nav">
                <li><a href=""><i class="icon ion-power"></i> تسجيل الخروج</a></li>
              </ul>
            </div><!-- dropdown-menu -->
          </div><!-- dropdown -->
        </nav>
        <div class="navicon-right">
    
        </div><!-- navicon-right -->
		 <div class="navicon-right">
    
        </div><!-- navicon-right -->
      </div><!-- br-header-right -->
    </div><!-- br-header -->
    <!-- ########## END: HEAD PANEL ########## -->

    <!-- ########## START: RIGHT PANEL ########## -->
 
    <!-- ########## END: RIGHT PANEL ########## --->

    <!-- ########## START: MAIN PANEL ########## -->
    <div class="br-mainpanel">
 
      <div class="br-pagetitle">
        <i class="icon icon ion-ios-photos"></i>
        <div>
          <h4 id="Bname"></h4>
         </div>
      </div><!-- d-flex -->

      <div class="br-pagebody pd-x-20 pd-sm-x-30">
      
 

        <div class="row row-sm mg-t-20">
          <div class="col-sm-6 col-lg-4">
            <div class="card shadow-base bd-0">
              <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
                <h6 class="card-title tx-uppercase tx-12 mg-b-0">مكان العمارة</h6>
                <span class="tx-12 tx-uppercase" id="Blocation"> </span>
              </div><!-- card-header -->
              <div class="card-body d-xs-flex justify-content-between align-items-center">
                <h4 class="mg-b-0 tx-inverse tx-lato tx-bold">عدد الشقق</h4>
                <p class="mg-b-0 tx-sm"><i class='fa fa-home tx-warning'></i> <span class="tx-warning"id ="BroomsCount"></span></p>
              </div><!-- card-body -->
            </div><!-- card -->
          </div><!-- col-4 -->
          <div class="col-sm-6 col-lg-4 mg-t-20 mg-sm-t-0">
            <div class="card shadow-base bd-0">
              <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
                <h6 class="card-title tx-uppercase tx-12 mg-b-0">عدد الطوابق</h6>
				<p class="mg-b-0 tx-sm"><i class="fa fa-bars tx-success"></i> <span class="tx-success" id="BfloorsCount"></span></p>
              </div><!-- card-header -->
              <div class="card-body d-xs-flex justify-content-between align-items-center">
                <h4 class="mg-b-0 tx-inverse tx-lato tx-bold"> التحصيل الشهري </h4>
				<p class="mg-b-0 tx-sm"><i class="fa fa-gem tx-danger" aria-hidden="true"></i> <span class="tx-danger" id="BtotalCollection"></span></p>
              </div><!-- card-body -->
            </div><!-- card -->
          </div><!-- col-4 -->
          <div class="col-sm-6 col-lg-4 mg-t-20 mg-lg-t-0">
            <div class="card shadow-base bd-0">
              <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
                <h6 class="card-title tx-uppercase tx-12 mg-b-0">قيمة الخدمات الشهرية </h6>
                <p class="mg-b-0 tx-sm"><i class="fa fa-gem tx-danger" aria-hidden="true"></i> <span class="tx-danger" id="BtotalServices"> </span></p>
              </div><!-- card-header -->
              <div class="card-body d-xs-flex justify-content-between align-items-center">
                <h4 class="mg-b-0 tx-inverse tx-lato tx-bold"></h4>
                <p class="mg-b-0 tx-sm"></p>
              </div><!-- card-body -->
            </div><!-- card -->
          </div><!-- col-4 -->
        </div><!-- row -->

      

     
 
 
 

        <div class="row row-sm mg-t-20">
 
          <div class="col-lg-12 mg-t-20 mg-lg-t-0">
            <div class="card shadow-base bd-0">
              <div class="card-header pd-20 bg-transparent">
                <h6 class="card-title tx-uppercase tx-12 mg-b-0">الشقق</h6>
              </div><!-- card-header -->
              <table class="table table-responsive mg-b-0 tx-12" id="apartmentsTable">
                <thead>
                  <tr class="tx-10">
                    <th class="wd-10p pd-y-5">&nbsp;</th>
                    <th class="pd-y-5">الاسم</th>
                    <th class="pd-y-5 tx-right">الرقم</th>
                    <th class="pd-y-5">مبلغ التحصيل</th>
                    <th class="pd-y-5">مؤجرة ؟</th>
                    <th class="pd-y-5">اظهر معلومات الشقة</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="pd-l-20">
                      <img src="https://via.placeholder.com/800x533" class="wd-55" alt="Image">
                    </td>
                    <td>
                      <a href="" class="tx-inverse tx-14 tx-medium d-block">شقة الاحمد</a>
                    </td>
                    <td class="valign-middle tx-right">3</td>
                    <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>540</span></td>
                    <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>نعم</span></td>
                    <td class="valign-middle">
                      <a href="" class="tx-gray-600 tx-22"><i class="icon ion-android-more-horizontal"></i></a>
                    </td>
                  </tr>
                       <tr>
                    <td class="pd-l-20">
                      <img src="https://via.placeholder.com/800x533" class="wd-55" alt="Image">
                    </td>
                    <td>
                      <a href="" class="tx-inverse tx-14 tx-medium d-block">شقة الاحمد</a>
                    </td>
                    <td class="valign-middle tx-right">3</td>
                    <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>540</span></td>
                    <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>نعم</span></td>
                    <td class="valign-middle">
                      <a href="" class="tx-gray-600 tx-22"><i class="icon ion-android-more-horizontal"></i></a>
                    </td>
                  </tr>
				            <tr>
                    <td class="pd-l-20">
                      <img src="https://via.placeholder.com/800x533" class="wd-55" alt="Image">
                    </td>
                    <td>
                      <a href="" class="tx-inverse tx-14 tx-medium d-block">شقة الاحمد</a>
                    </td>
                    <td class="valign-middle tx-right">3</td>
                    <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>540</span></td>
                    <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>نعم</span></td>
                    <td class="valign-middle ">
                      <a href="" class="tx-gray-600 tx-22"><i class="icon ion-android-more-horizontal"></i></a>
                    </td>
                  </tr>
                
         
                </tbody>
              </table>
              <div class="card-footer tx-12 pd-y-15 bg-transparent">
                <a href=""class="tx-15 tx-success"><i class="fa fa-plus mg-r-5 tx-danger"></i> اضافة شقة جديدة في هذه العمارة </a>
              </div><!-- card-footer -->
            </div><!-- card -->
          </div><!-- col-6 -->
        </div><!-- row -->

       
      </div><!-- br-pagebody -->

      <div id="modaldemo8" class="modal fade">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content bd-0 tx-14">
            <div class="modal-header pd-y-20 pd-x-25">
              <h6 class="tx-14 mg-b-0 tx-uppercase tx-inverse tx-bold">Message Preview</h6>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body pd-25 tx-right">
              <h4 class="lh-3 mg-b-20 tx-inverse">Why We Use Electoral College, Not Popular Vote</h4>
              <p class="mg-b-5">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters, as opposed to using 'Content here, content here', making it look like readable English. </p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary tx-11 tx-uppercase pd-y-12 pd-x-25 tx-mont tx-medium mg-r-0 mg-l-5">Save changes</button>
              <button type="button" class="btn btn-secondary tx-11 tx-uppercase pd-y-12 pd-x-25 tx-mont tx-medium mg-l-0 mg-r-5" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div><!-- modal-dialog -->
      </div><!-- modal -->

      <footer class="br-footer">
 
      </footer>
    </div><!-- br-mainpanel -->
    <!-- ########## END: MAIN PANEL ########## -->

    <script src="lib/jquery/jquery.min.js"></script>
    <script src="lib/jquery-ui/ui/widgets/datepicker.js"></script>
    <script src="lib/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="lib/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script src="lib/moment/min/moment.min.js"></script>
    <script src="lib/peity/jquery.peity.min.js"></script>
    <script src="lib/jquery-sparkline/jquery.sparkline.min.js"></script>
    <script src="lib/rickshaw/vendor/d3.min.js"></script>
    <script src="lib/rickshaw/vendor/d3.layout.min.js"></script>
    <script src="lib/rickshaw/rickshaw.min.js"></script>

    <script src="js/bracket.js"></script>
    <script src="js/ResizeSensor.js"></script>
    <script src="js/widgets.js"></script>
    <script>
      $(function(){
        'use strict'

        // FOR DEMO ONLY
        // menu collapsed by default during first page load or refresh with screen
        // having a size between 992px and 1199px. This is intended on this page only
        // for better viewing of widgets demo.
        $(window).resize(function(){
          minimizeMenu();
        });

        minimizeMenu();

        function minimizeMenu() {
          if(window.matchMedia('(min-width: 992px)').matches && window.matchMedia('(max-width: 1199px)').matches) {
            // show only the icons and hide left menu label by default
            $('.menu-item-label,.menu-item-arrow').addClass('op-lg-0-force d-lg-none');
            $('body').addClass('collapsed-menu');
            $('.show-sub + .br-menu-sub').slideUp();
          } else if(window.matchMedia('(min-width: 1200px)').matches && !$('body').hasClass('collapsed-menu')) {
            $('.menu-item-label,.menu-item-arrow').removeClass('op-lg-0-force d-lg-none');
            $('body').removeClass('collapsed-menu');
            $('.show-sub + .br-menu-sub').slideDown();
          }
        }
      });
      // Step 1: Get the building ID from the URL
      const urlParams = new URLSearchParams(window.location.search);
      const buildingId = urlParams.get('id');
      console.log("Building Id is :- "+ buildingId);
      // Step 2: Fetch building details
      if (buildingId) {
        fetchBuildingDetails(buildingId);
        fetchApartments(buildingId);
      } else {
        console.error('No building ID provided in URL');
      }

      function fetchBuildingDetails(id) {
        const apiUrl = `https://apartman-service-production.up.railway.app/buildings/${id}`;
        
        fetch(apiUrl, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJraGFsZWQuYXNmdXJAZ21haWwuY29tIiwiaWF0IjoxNzMwODU0ODEyLCJleHAiOjE3MzM0NDY4MTJ9.uHj37pf2zyxfJXv6BgE-M-Gva5HwOqu6TpWSd32sKWw'
          }
        })
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
            // Step 3: Display building details
            // document.getElementById('building-id').textContent = data.id;
            document.getElementById('Bname').textContent ="عمارة "+ data.name;
            document.getElementById('Blocation').textContent = data.address;
            document.getElementById('BroomsCount').textContent = data.apartmentCount;
            document.getElementById('BfloorsCount').textContent = data.floorsCount;
            document.getElementById('BtotalServices').textContent = data.monthlyFees || '-';
            document.getElementById('BtotalCollection').textContent = data.monthlyRentPrice;
            console.log(data.name);
            console.log(data.monthlyRentPrice);
        })
        .catch(error => {
          console.error('Error fetching building details:', error);
        });
      }

      function fetchApartments(buildingId) {
      const apiUrl = `https://apartman-service-production.up.railway.app/apartments/building-apartments/${buildingId}`;

      fetch(apiUrl, {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJraGFsZWQuYXNmdXJAZ21haWwuY29tIiwiaWF0IjoxNzMwODU0ODEyLCJleHAiOjE3MzM0NDY4MTJ9.uHj37pf2zyxfJXv6BgE-M-Gva5HwOqu6TpWSd32sKWw'
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
      })
      .then(apartments => {
        const apartmentsTableBody = document.querySelector('#apartmentsTable tbody');
        apartmentsTableBody.innerHTML = ''; // Clear any existing rows

        apartments.forEach(apartment => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td class="pd-l-20"><img src="https://via.placeholder.com/800x533" class="wd-55" alt="Image"></td>
            <td><a href="" class="tx-inverse tx-14 tx-medium d-block">${apartment.name}</a></td>
            <td>11</td>
            <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>${apartment.monthlyRentValue} ${apartment.currency}</span></td>
            <td class="valign-middle"><span class="tx-success"><i class="icon ion-android-arrow-up mg-r-5"></i>${apartment.available}</span></td>
            <td><a href="#" class="modal-effect btn btn-primary btn-block" data-effect="effect-fall">Fall</a></td>
          `;
          apartmentsTableBody.appendChild(row);
        });
      })
      .catch(error => {
        console.error('Error fetching apartments:', error);
      });
    }

    $(function(){
      // showing modal with effect
      $('.modal-effect').on('click', function(e){
        e.preventDefault();

        var effect = $(this).attr('data-effect');
        $('#modaldemo8').addClass(effect);
        $('#modaldemo8').modal('show');
      });

      // hide modal with effect
      $('#modaldemo8').on('hidden.bs.modal', function (e) {
        $(this).removeClass (function (index, className) {
            return (className.match (/(^|\s)effect-\S+/g) || []).join(' ');
        });
      });
    });
    </script>
  </body>
</html>
